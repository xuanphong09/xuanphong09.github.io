<!DOCTYPE html>
<html lang="vi">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Happy Birthday VIP</title>
        <style>
            /* --- 1. C·∫§U H√åNH C∆† B·∫¢N --- */
            @import url("https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap");

            body {
                margin: 0;
                padding: 0;
                background-color: #000;
                overflow: hidden;
                font-family: "Press Start 2P", cursive;
                color: #ffb6c1;
            }

            /* --- 2. M√ÄN H√åNH LOADING --- */
            #loading {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: #000;
                z-index: 100;
                display: flex;
                justify-content: center;
                align-items: center;
                flex-direction: column;
                transition: opacity 1s;
            }
            .loader-text {
                animation: blink 1s infinite;
            }

            /* --- 3. MATRIX BACKGROUND --- */
            canvas {
                display: block;
                position: fixed;
                top: 0;
                left: 0;
                z-index: 1;
            }

            /* --- 4. TEXT OVERLAY (HI·ªÜN CH·ªÆ 3, 2, 1, HAPPY...) --- */
            #text-overlay {
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                z-index: 10;
                width: 100%;
                text-align: center;
                pointer-events: none; /* ƒê·ªÉ kh√¥ng che m·∫•t c√°c thao t√°c kh√°c */
            }

            /* T·∫°o hi·ªáu ·ª©ng ch·ªØ LED ch·∫•m bi nh∆∞ b·∫°n th√≠ch */
            .matrix-text {
                font-size: 8rem;
                font-weight: 900;
                font-family: sans-serif; /* D√πng font d√†y ƒë·ªÉ hi·ªán r√µ ch·∫•m */
                color: transparent;
                background-image: radial-gradient(#ff69b4 30%, transparent 32%);
                background-size: 8px 8px;
                -webkit-background-clip: text;
                background-clip: text;
                opacity: 0;
                transform: scale(0.5);
                transition: all 0.5s ease-out;
                text-shadow: 0 0 20px rgba(255, 20, 147, 0.5); /* B√≥ng m·ªù h·ªìng */
            }

            .matrix-text.active {
                opacity: 1;
                transform: scale(1);
            }

            /* --- 5. PH·∫¶N QU√Ä T·∫∂NG & ·∫¢NH TR√ÅI TIM --- */
            #gallery-container {
                display: none;
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                z-index: 20;
                background: radial-gradient(circle, #1a0b1a 0%, #000 100%);
                perspective: 1000px; /* T·∫°o chi·ªÅu s√¢u 3D */
                overflow: hidden;
            }

            /* N√∫t h·ªôp qu√† */
            #gift-box {
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                font-size: 5rem;
                cursor: pointer;
                animation: bounce 2s infinite;
                z-index: 30;
            }

            /* Khung ch·ª©a xoay v√≤ng tr√°i tim */
            #heart-group {
                position: absolute;
                top: 50%;
                left: 50%;
                width: 0;
                height: 0;
                transform-style: preserve-3d;
                animation: rotateHeart 20s linear infinite;
            }

            .photo-card {
                position: absolute;
                width: 60px; /* K√≠ch th∆∞·ªõc ·∫£nh nh·ªè */
                height: 80px;
                background-size: cover;
                background-position: center;
                border: 2px solid #fff;
                border-radius: 5px;
                box-shadow: 0 0 10px #ff69b4;
                opacity: 0; /* ·∫®n ban ƒë·∫ßu */
                transition: all 1.5s ease; /* Hi·ªáu ·ª©ng bay ra m∆∞·ª£t m√† */
                transform-origin: center;
            }

            /* --- ANIMATIONS --- */
            @keyframes blink {
                50% {
                    opacity: 0.5;
                }
            }
            @keyframes bounce {
                0%,
                100% {
                    transform: translate(-50%, -50%) scale(1);
                }
                50% {
                    transform: translate(-50%, -60%) scale(1.1);
                }
            }
            @keyframes rotateHeart {
                0% {
                    transform: rotateY(0deg) rotateX(10deg);
                }
                100% {
                    transform: rotateY(360deg) rotateX(10deg);
                }
            }

            /* Nh·∫°c n·ªÅn (·∫®n) */
            #bg-music {
                display: none;
            }

            .final-msg {
                position: absolute;
                bottom: 20px;
                width: 100%;
                text-align: center;
                color: white;
                font-size: 1.2rem;
                text-shadow: 0 0 10px pink;
            }
        </style>
    </head>
    <body>
        <div id="loading">
            <div class="loader-text">ƒêANG T·∫¢I D·ªÆ LI·ªÜU C·∫¢M X√öC...</div>
            <div style="margin-top: 10px; font-size: 10px">
                (Ch·∫°m v√†o m√†n h√¨nh ƒë·ªÉ b·∫Øt ƒë·∫ßu nh·∫°c)
            </div>
        </div>

        <canvas id="matrixCanvas"></canvas>

        <div id="text-overlay">
            <div id="dynamic-text" class="matrix-text"></div>
        </div>

        <div id="gallery-container">
            <div id="gift-box" onclick="openGift()">üéÅ</div>
            <div id="heart-group"></div>
            <div class="final-msg" id="final-msg" style="display: none">
                CH√öC M·ª™NG SINH NH·∫¨T NG∆Ø·ªúI ƒê·∫∂C BI·ªÜT! ‚ù§Ô∏è
            </div>
        </div>

        <audio id="bg-music" loop>
            <source
                src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3"
                type="audio/mpeg"
            />
        </audio>

        <script>
            // --- C·∫§U H√åNH ---
            // Thay danh s√°ch ·∫£nh c·ªßa b·∫°n v√†o ƒë√¢y (C√†ng nhi·ªÅu ·∫£nh c√†ng ƒë·∫πp, kho·∫£ng 30-50 c√°i)
            const imageUrls = [
                "https://images.unsplash.com/photo-1524504388940-b1c1722653e1?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&w=400",
                "https://images.unsplash.com/photo-1494790108377-be9c29b29330?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&w=400",
                "https://images.unsplash.com/photo-1517841905240-472988babdf9?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&w=400",
                "https://images.unsplash.com/photo-1534528741775-53994a69daeb?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&w=400",
                // ... B·∫°n c√≥ th·ªÉ copy paste th√™m link ·∫£nh v√†o ƒë√¢y
                "https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&w=400",
                "https://images.unsplash.com/photo-1529626455594-4ff0802cfb7e?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&w=400",
                "https://images.unsplash.com/photo-1513151233558-d860c5398176?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&w=400",
            ];

            // T·ª± ƒë·ªông nh√¢n b·∫£n ·∫£nh cho ƒë·ªß s·ªë l∆∞·ª£ng l√†m tr√°i tim (n·∫øu √≠t ·∫£nh qu√°)
            while (imageUrls.length < 50) {
                imageUrls.push(...imageUrls);
            }

            // --- PH·∫¶N 1: MATRIX RAIN (H·ªìng) ---
            const canvas = document.getElementById("matrixCanvas");
            const ctx = canvas.getContext("2d");
            let width = (canvas.width = window.innerWidth);
            let height = (canvas.height = window.innerHeight);

            const cols = Math.floor(width / 20);
            const yPos = Array(cols).fill(0);

            function drawMatrix() {
                ctx.fillStyle = "rgba(0, 0, 0, 0.05)";
                ctx.fillRect(0, 0, width, height);

                ctx.fillStyle = "#ff69b4"; // M√†u ch·ªØ Matrix (H·ªìng)
                ctx.font = "15px monospace";

                yPos.forEach((y, index) => {
                    const text = String.fromCharCode(Math.random() * 128);
                    const x = index * 20;
                    ctx.fillText(text, x, y);

                    if (y > height && Math.random() > 0.975) {
                        yPos[index] = 0;
                    } else {
                        yPos[index] = y + 20;
                    }
                });
            }

            let matrixInterval;

            // --- PH·∫¶N 2: LOGIC CH·∫†Y K·ªäCH B·∫¢N ---

            window.onload = () => {
                // Click ƒë·ªÉ b·∫Øt ƒë·∫ßu (tr√°nh l·ªói tr√¨nh duy·ªát ch·∫∑n nh·∫°c)
                document.body.addEventListener("click", startShow);
            };

            function startShow() {
                document.body.removeEventListener("click", startShow);

                // 1. ·∫®n Loading, B·∫≠t nh·∫°c
                document.getElementById("loading").style.opacity = 0;
                setTimeout(
                    () =>
                        (document.getElementById("loading").style.display =
                            "none"),
                    1000
                );

                const music = document.getElementById("bg-music");
                music
                    .play()
                    .catch((e) => console.log("C·∫ßn t∆∞∆°ng t√°c ƒë·ªÉ ph√°t nh·∫°c"));

                // 2. Ch·∫°y Matrix
                matrixInterval = setInterval(drawMatrix, 50);

                // 3. B·∫Øt ƒë·∫ßu ƒë·∫øm ng∆∞·ª£c sau 1s
                setTimeout(runSequence, 1000);
            }

            const textEl = document.getElementById("dynamic-text");

            async function runSequence() {
                // H√†m hi·ªÉn th·ªã ch·ªØ nh·∫•p nh√°y
                const showText = (text, duration) => {
                    return new Promise((resolve) => {
                        textEl.innerText = text;
                        textEl.classList.add("active"); // Hi·ªán

                        setTimeout(() => {
                            textEl.classList.remove("active"); // ·∫®n
                            setTimeout(resolve, 600); // Ch·ªù ·∫©n xong m·ªõi resolve
                        }, duration);
                    });
                };

                // K·ªãch b·∫£n ch·∫°y ch·ªØ (B·∫°n c√≥ th·ªÉ s·ª≠a n·ªôi dung ·ªü ƒë√¢y)
                await showText("3", 1000);
                await showText("2", 1000);
                await showText("1", 1000);
                await showText("HAPPY", 1200);
                await showText("BIRTHDAY", 1200);
                await showText("TO", 800);
                await showText("YOU", 1200);
                await showText("‚ù§Ô∏è", 1500);

                // K·∫øt th√∫c Matrix, chuy·ªÉn sang qu√†
                finishMatrix();
            }

            function finishMatrix() {
                clearInterval(matrixInterval);
                // X√≥a d·∫ßn canvas
                let op = 1;
                const fadeOut = setInterval(() => {
                    if (op <= 0) {
                        clearInterval(fadeOut);
                        canvas.style.display = "none";
                        document.getElementById(
                            "gallery-container"
                        ).style.display = "block"; // Hi·ªán m√†n qu√†
                    }
                    canvas.style.opacity = op;
                    op -= 0.05;
                }, 50);
            }

            // --- PH·∫¶N 3: X·∫æP ·∫¢NH H√åNH TR√ÅI TIM 3D ---

            function openGift() {
                const giftBox = document.getElementById("gift-box");
                giftBox.style.display = "none"; // ·∫®n h·ªôp qu√†

                document.getElementById("final-msg").style.display = "block";

                const heartGroup = document.getElementById("heart-group");
                const totalPhotos = 40; // S·ªë l∆∞·ª£ng ·∫£nh mu·ªën hi·ªán
                const radius = 350; // ƒê·ªô l·ªõn c·ªßa tr√°i tim

                // C√¥ng th·ª©c to√°n h·ªçc t·∫°o h√¨nh tr√°i tim 3D
                // Ch√∫ng ta s·∫Ω r·∫£i ·∫£nh theo c√°c t·ªça ƒë·ªô (x, y, z)

                for (let i = 0; i < totalPhotos; i++) {
                    const imgDiv = document.createElement("div");
                    imgDiv.className = "photo-card";
                    // L·∫•y ·∫£nh ng·∫´u nhi√™n t·ª´ danh s√°ch
                    const imgUrl = imageUrls[i % imageUrls.length];
                    imgDiv.style.backgroundImage = `url(${imgUrl})`;

                    heartGroup.appendChild(imgDiv);

                    // T√≠nh to√°n v·ªã tr√≠ tr√°i tim
                    // D√πng c√¥ng th·ª©c tham s·ªë cho ƒë∆∞·ªùng cong tr√°i tim
                    // t ƒëi t·ª´ 0 ƒë·∫øn 2PI
                    const t = (Math.PI * 2 * i) / totalPhotos;

                    // C√¥ng th·ª©c tr√°i tim 2D c∆° b·∫£n:
                    // x = 16sin^3(t)
                    // y = 13cos(t) - 5cos(2t) - 2cos(3t) - cos(4t)

                    // Scale to ra
                    let x = 16 * Math.pow(Math.sin(t), 3);
                    let y = -(
                        13 * Math.cos(t) -
                        5 * Math.cos(2 * t) -
                        2 * Math.cos(3 * t) -
                        Math.cos(4 * t)
                    );

                    // Random nh·∫π Z ƒë·ªÉ t·∫°o ƒë·ªô d√†y 3D
                    let z = (Math.random() - 0.5) * 100;

                    // Scale k√≠ch th∆∞·ªõc
                    x *= 15;
                    y *= 15;

                    // G√°n v·ªã tr√≠ ban ƒë·∫ßu (·ªü t√¢m) ƒë·ªÉ t·∫°o hi·ªáu ·ª©ng bay ra
                    imgDiv.style.transform = `translate(-50%, -50%) translate3d(0px, 0px, 0px)`;

                    // Sau 1 ch√∫t th√¨ bay ra v·ªã tr√≠ tr√°i tim
                    setTimeout(() => {
                        imgDiv.style.opacity = 1;
                        // Xoay ·∫£nh h∆∞·ªõng v·ªÅ t√¢m
                        imgDiv.style.transform = `translate(-50%, -50%) translate3d(${x}px, ${y}px, ${z}px) rotateY(${
                            i * 10
                        }deg)`;
                    }, 50 + i * 30); // Bay ra l·∫ßn l∆∞·ª£t
                }
            }

            // Resize m√†n h√¨nh
            window.addEventListener("resize", () => {
                width = canvas.width = window.innerWidth;
                height = canvas.height = window.innerHeight;
            });
        </script>
    </body>
</html>
